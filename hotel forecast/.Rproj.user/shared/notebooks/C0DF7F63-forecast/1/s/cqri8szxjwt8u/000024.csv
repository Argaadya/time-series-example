"0","hotel %>% "
"0","  filter(is_canceled == F) %>% "
"0","  group_by(hotel, market_segment) %>% "
"0","  summarise(adr = sum(adr)) %>% "
"0","  mutate(total = sum(adr),"
"0","         ratio = adr/total) %>% "
"0","  ungroup() %>% "
"0","  mutate(market_segment = tidytext::reorder_within(market_segment, ratio, hotel)) %>% "
"0","  ggplot(aes(ratio, market_segment)) +"
"0","  geom_point() +"
"0","  geom_segment(aes(y = market_segment, yend = market_segment, x= 0, xend = ratio)) +"
"0","  facet_wrap(~hotel, scales = ""free_y"") +"
"0","  tidytext::scale_y_reordered() +"
"0","  scale_x_continuous(labels = percent_format(accuracy = 1)) +"
"0","  theme_pander() +"
"0","  labs(x = NULL, y = NULL, "
"0","       title = ""Average Daily Rate (ADR) Contributions by Market Segments"")"
