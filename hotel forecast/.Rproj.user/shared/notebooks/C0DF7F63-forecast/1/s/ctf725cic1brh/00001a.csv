"0","hotel %>% "
"0","  count(hotel, market_segment, is_canceled) %>% "
"0","  group_by(hotel) %>% "
"0","  mutate(total = sum(n),"
"0","         ratio = n/total,"
"0","         is_canceled = ifelse(is_canceled == 0, ""No"", ""Yes"")) %>% "
"0","  ungroup() %>% "
"0","  mutate(market_segment = tidytext::reorder_within(market_segment, ratio, hotel)) %>%  "
"0","  ggplot(aes(ratio, market_segment, fill = is_canceled)) +"
"0","  geom_col(position = ""dodge"") +"
"0","  labs(x = ""Percentage"", y = ""Market Segment"", "
"0","       title = ""Hotel Demand by Market Segment"","
"0","       fill = ""Booking Canceled"") +"
"0","  facet_wrap(~hotel, scales = ""free_y"") +"
"0","  scale_x_continuous(labels = percent_format(accuracy = 1)) +"
"0","  scale_fill_manual(values = c(""skyblue"", ""firebrick"")) +"
"0","  tidytext::scale_y_reordered() +"
"0","  theme_pander() +"
"0","  theme(legend.position = ""top"")"
