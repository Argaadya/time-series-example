"0","list_hotel <- hotel_agg %>% "
"0","  select(-arrival_date) %>% "
"0","  unite(""series"", hotel, market_segment, sep = "";"") %>% "
"0","  nest(-series)"
"0",""
"0","freq_num <- c(7, 30, 365)"
"0",""
"0","list_hotel <- list_hotel %>% "
"0","  crossing(freq_num) %>% "
"0","  unite(""series"", series, freq_num, sep = "";"")"
"0",""
"0","freq_num <- as.list(rep(freq_num,6))"
"0",""
"0","ts_feature <- map2(list_hotel$data, freq_num, ~ts(data = .x, frequency = .y)) %>% "
"0","  map(stl_features) %>% "
"0","  unlist() %>% "
"0","  matrix(nrow = nrow(list_hotel), byrow = T) %>% "
"0","  as.data.frame() %>% "
"0","  `names<-`(names(hotel_feature)) %>% "
"0","  mutate(series = list_hotel$series) %>% "
"0","  select(series, seasonal_period, trend, seasonal_strength, everything()) %>% "
"0","  separate(series, c(""hotel"", ""market_segment"", ""frequency""), sep = "";"") %>% "
"0","  select(-frequency)"
"0",""
"0","ts_feature  %>% "
"0","  arrange(desc(seasonal_strength))"
